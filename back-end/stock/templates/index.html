<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì‹¤ì‹œê°„ ì£¼ì‹ ëª¨ë‹ˆí„°ë§</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        #log { 
            border: 1px solid #ccc; 
            padding: 10px; 
            height: 400px; 
            overflow-y: scroll; 
            background: #f9f9f9; 
        }
        .item { margin-bottom: 5px; border-bottom: 1px solid #eee; }
    </style>
</head>
<body>
    <h1>ğŸš€ ì‹¤ì‹œê°„ ì²´ê²° ë°ì´í„° (Localhost)</h1>
    <div id="log">ë°ì´í„° ëŒ€ê¸° ì¤‘...</div>

    <script>
        // 1. Localhost ì›¹ì†Œì¼“ ì—°ê²°
        const socket = new WebSocket('ws://localhost:8000/ws/stock/');

        // 2. ì—°ê²° ì„±ê³µ ì‹œ
        socket.onopen = function(e) {
            console.log('âœ… ì›¹ì†Œì¼“ ì—°ê²° ì„±ê³µ!');
            document.getElementById('log').innerHTML = ''; // ì´ˆê¸°í™”
        };

        // 3. ë°ì´í„° ìˆ˜ì‹  ì‹œ (ê°€ì¥ ì¤‘ìš”)
        socket.onmessage = function(e) {
            const data = JSON.parse(e.data);
            const message = data.message; // ì„œë²„ì—ì„œ ë³´ë‚¸ ì‹¤ì œ ë°ì´í„°
            
            // í™”ë©´ì— ì¶”ê°€
            const logDiv = document.getElementById('log');
            const newItem = document.createElement('div');
            newItem.className = 'item';
            
            // JSON ê°ì²´ë¼ë©´ ë¬¸ìì—´ë¡œ ë³€í™˜í•´ì„œ ì¶œë ¥, ë¬¸ìì—´ì´ë©´ ê·¸ëŒ€ë¡œ ì¶œë ¥
            newItem.innerText = typeof message === 'object' ? JSON.stringify(message) : message;
            
            logDiv.appendChild(newItem);
            
            // ìŠ¤í¬ë¡¤ ìë™ ë‚´ë¦¬ê¸°
            logDiv.scrollTop = logDiv.scrollHeight;
        };

        // 4. ì—°ê²° ì¢…ë£Œ ì‹œ
        socket.onclose = function(e) {
            console.error('âŒ ì›¹ì†Œì¼“ ì—°ê²° ëŠê¹€');
        };
    </script>
</body>
</html>